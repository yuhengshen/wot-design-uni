import{d as e,r as l,x as a,y as o,V as s,b as t,c as r,e as i,f as c,w as d,g as u,z as n,n as p,A as m,i as f,h as v,t as b,F as y,s as k,u as h,C as _,j as w,ac as g,k as x,ad as C,D as V,l as $}from"./index-ddWhPHnE.js";import{b as S,c as K,d as z,m as j,l as F,n as I,e as q,w as A,i as B,g as M,p as O,r as T,_ as P}from"./wd-icon.CdzlT4Xd.js";import{_ as W}from"./wd-search.CNdZJIuN.js";import{_ as D}from"./wd-action-sheet.DPz_7n2j.js";import{_ as L}from"./wd-checkbox.DRdAN4Zd.js";import{w as U}from"./wd-checkbox-group.DQsVbreC.js";import{a as R,_ as E}from"./wd-radio-group.Bgv59YnE.js";import{_ as G}from"./wd-button.D-L9G8tD.js";import{g as H}from"./page-wraper.DJ6J_9uw.js";import{a as N,u as J,F as Q}from"./wd-cell.DKtYKzk0.js";import{u as X}from"./useTranslate.D-OItNaP.js";const Y=P(e({name:"wd-select-picker",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"},props:{...S,label:String,labelWidth:K("33%"),disabled:z(!1),readonly:Boolean,placeholder:String,title:String,alignRight:z(!1),error:z(!1),required:z(!1),useLabelSlot:z(!1),useDefaultSlot:z(!1),size:String,checkedColor:String,min:j(0),max:j(0),selectSize:String,loading:z(!1),loadingColor:K("#4D80F0"),closeOnClickModal:z(!0),modelValue:F([String,Number,Boolean,Array]),columns:I(),type:K("checkbox"),valueKey:K("value"),labelKey:K("label"),confirmButtonText:String,displayFormat:Function,beforeConfirm:Function,zIndex:j(15),safeAreaInsetBottom:z(!0),filterable:z(!1),filterPlaceholder:String,ellipsis:z(!1),scrollIntoView:z(!0),prop:String,rules:I(),customContentClass:K(""),customLabelClass:K(""),customValueClass:K(""),showConfirm:z(!0),clearable:z(!1)},emits:["change","cancel","confirm","clear","update:modelValue","open","close"],setup(e,{expose:S,emit:K}){const{translate:z}=X("select-picker"),j=e,F=K,I=l(!1),P=l([]),Y=l(!1),Z=l([]),ee=l(""),le=l([]),ae=l(0),oe=N(),se=a((()=>{const e=ne(j.modelValue);let l="";if(j.displayFormat)l=j.displayFormat(e,j.columns);else{const{type:a,labelKey:o}=j;if("checkbox"===a){l=(q(e)?e:[]).map((e=>ue(e))).map((e=>e[o])).join(", ")}else if("radio"===a){l=ue(e)[o]}else l=e}return l}));o((()=>j.modelValue),(e=>{e!==P.value&&(P.value=ne(e),Z.value=ne(e))}),{deep:!0,immediate:!0}),o((()=>j.columns),(e=>{j.filterable&&ee.value?he(e,ee.value):le.value=e}),{deep:!0,immediate:!0}),o((()=>j.displayFormat),(e=>{e&&!T(e)&&console.error("The type of displayFormat must be Function")}),{deep:!0,immediate:!0}),o((()=>j.beforeConfirm),(e=>{e&&!T(e)&&console.error("The type of beforeConfirm must be Function")}),{deep:!0,immediate:!0});const{parent:te}=J(Q),re=a((()=>te&&j.prop&&te.errorMessages&&te.errorMessages[j.prop]?te.errorMessages[j.prop]:"")),ie=a((()=>{let e=!1;if(te&&te.props.rules){const l=te.props.rules;for(const a in l)Object.prototype.hasOwnProperty.call(l,a)&&a===j.prop&&Array.isArray(l[a])&&(e=l[a].some((e=>e.required)))}return j.required||j.rules.some((e=>e.required))||e}));s((()=>{P.value=ne(j.modelValue),le.value=j.columns}));const{proxy:ce}=V();function de(){}function ue(e){const{valueKey:l,labelKey:a,columns:o}=j,s=o.filter((a=>a[l]===e));return s.length>0?s[0]:{[l]:e,[a]:""}}function ne(e){return"checkbox"===j.type?q(e)?e:[]:e}function pe({value:e}){P.value=e,F("change",{value:e}),"radio"!==j.type||j.showConfirm||ve()}function me(){I.value=!1,Y.value||(P.value=ne(Z.value)),F("cancel"),F("close")}function fe(){j.disabled||j.readonly||(P.value=ne(j.modelValue),I.value=!0,Y.value=!1,F("open"))}function ve(){if(j.loading)return I.value=!1,F("confirm"),void F("close");j.beforeConfirm?j.beforeConfirm(P.value,(e=>{e&&be()})):be()}function be(){Y.value=!0,I.value=!1,Z.value=ne(P.value);let e={};e="checkbox"===j.type?(q(Z.value)?Z.value:[]).map((e=>ue(e))):ue(Z.value),F("update:modelValue",Z.value),F("confirm",{value:Z.value,selectedItems:e}),F("close")}function ye(e,l){const a=new RegExp(`(${l})`,"g");return e.split(a).map((e=>({type:e===l?"active":"normal",label:e})))}function ke({value:e}){""===e?(le.value=[],ee.value=e,g((()=>{le.value=j.columns}))):(ee.value=e,he(j.columns,e))}function he(e,l){const a=e.filter((e=>e[j.labelKey].indexOf(l)>-1)).map((e=>({...e,[j.labelKey]:ye(e[j.labelKey],l)})));le.value=[],g((()=>{le.value=a}))}const _e=a((()=>"radio"===j.type&&j.showConfirm||"checkbox"===j.type)),we=a((()=>j.clearable&&!j.disabled&&!j.readonly&&se.value.length));function ge(){F("update:modelValue","checkbox"===j.type?[]:""),F("clear")}const xe=a((()=>!j.disabled&&!j.readonly&&!we.value));return S({close:me,open:fe}),(e,l)=>{const a=x,o=t(r("wd-icon"),A),s=t(r("wd-search"),W),V=$,S=C;return i(),c(a,{class:p(`wd-select-picker ${h(oe).border.value?"is-border":""} ${e.customClass}`),style:m(e.customStyle)},{default:d((()=>[u(a,{class:"wd-select-picker__field",onClick:fe},{default:d((()=>[e.useDefaultSlot?n(e.$slots,"default",{key:0},void 0,!0):(i(),c(a,{key:1,class:p(`wd-select-picker__cell ${e.disabled&&"is-disabled"} ${j.readonly&&"is-readonly"} ${e.alignRight&&"is-align-right"} ${e.error&&"is-error"} ${e.size&&"is-"+e.size}`)},{default:d((()=>[e.label||e.useLabelSlot?(i(),c(a,{key:0,class:p(`wd-select-picker__label ${ie.value&&"is-required"} ${e.customLabelClass}`),style:m(e.labelWidth?"min-width:"+e.labelWidth+";max-width:"+e.labelWidth+";":"")},{default:d((()=>[e.label?(i(),f(y,{key:0},[v(b(e.label),1)],64)):n(e.$slots,"label",{key:1},void 0,!0)])),_:3},8,["class","style"])):k("",!0),u(a,{class:"wd-select-picker__body"},{default:d((()=>[u(a,{class:"wd-select-picker__value-wraper"},{default:d((()=>[u(a,{class:p(`wd-select-picker__value ${e.ellipsis&&"is-ellipsis"} ${e.customValueClass} ${se.value?"":"wd-select-picker__value--placeholder"}`)},{default:d((()=>[v(b(se.value||e.placeholder||h(z)("placeholder")),1)])),_:1},8,["class"]),xe.value?(i(),c(o,{key:0,"custom-class":"wd-select-picker__arrow",name:"arrow-right"})):we.value?(i(),c(a,{key:1,onClick:_(ge,["stop"])},{default:d((()=>[u(o,{"custom-class":"wd-select-picker__clear",name:"error-fill"})])),_:1})):k("",!0)])),_:1}),re.value?(i(),c(a,{key:0,class:"wd-select-picker__error-message"},{default:d((()=>[v(b(re.value),1)])),_:1})):k("",!0)])),_:1})])),_:3},8,["class"]))])),_:3}),u(D,{modelValue:I.value,"onUpdate:modelValue":l[3]||(l[3]=e=>I.value=e),duration:250,title:e.title||h(z)("title"),"close-on-click-modal":e.closeOnClickModal,"z-index":e.zIndex,"safe-area-inset-bottom":e.safeAreaInsetBottom,onClose:me,onOpened:l[4]||(l[4]=l=>e.scrollIntoView?async function(){let e="",l=[];B(P.value)&&""!==P.value&&!q(P.value)?(e="#wd-radio-group",l=[M(`#radio${P.value}`,!1,ce)]):q(P.value)&&P.value.length>0&&(P.value.forEach((e=>{l.push(M(`#check${e}`,!1,ce))})),e="#wd-checkbox-group"),e&&(await O(2e3/30),Promise.all([M(".wd-select-picker__wrapper",!1,ce),M(e,!1,ce),...l]).then((e=>{if(B(e)&&q(e)){const l=e[0],a=e[1],o=e.slice(2)||[];B(a)&&B(l)&&o.findIndex((e=>e.bottom>l.top&&e.top<l.bottom))<0&&(ae.value=-1,g((()=>{ae.value=Math.max(0,o[0].top-a.top-l.height/2)})))}})))}():""),"custom-header-class":"wd-select-picker__header"},{default:d((()=>[e.filterable?(i(),c(s,{key:0,modelValue:ee.value,"onUpdate:modelValue":l[0]||(l[0]=e=>ee.value=e),placeholder:e.filterPlaceholder||h(z)("filterPlaceholder"),"hide-cancel":"","placeholder-left":"",onChange:ke},null,8,["modelValue","placeholder"])):k("",!0),u(S,{class:p(`wd-select-picker__wrapper ${e.filterable?"is-filterable":""} ${e.loading?"is-loading":""} ${e.customContentClass}`),"scroll-y":!e.loading,"scroll-top":ae.value,"scroll-with-animation":!0},{default:d((()=>["checkbox"===e.type&&h(q)(P.value)?(i(),c(a,{key:0,id:"wd-checkbox-group"},{default:d((()=>[u(U,{modelValue:P.value,"onUpdate:modelValue":l[1]||(l[1]=e=>P.value=e),cell:"",size:e.selectSize,"checked-color":e.checkedColor,min:e.min,max:e.max,onChange:pe},{default:d((()=>[(i(!0),f(y,null,w(le.value,(l=>(i(),c(a,{key:l[e.valueKey],id:"check"+l[e.valueKey]},{default:d((()=>[u(L,{modelValue:l[e.valueKey],disabled:l.disabled},{default:d((()=>[e.filterable&&ee.value?(i(!0),f(y,{key:0},w(l[e.labelKey],(e=>(i(),f(y,{key:e.label},["active"===e.type?(i(),c(V,{key:0,class:"wd-select-picker__text-active"},{default:d((()=>[v(b(e.label),1)])),_:2},1024)):(i(),f(y,{key:1},[v(b(e.label),1)],64))],64)))),128)):(i(),f(y,{key:1},[v(b(l[e.labelKey]),1)],64))])),_:2},1032,["modelValue","disabled"])])),_:2},1032,["id"])))),128))])),_:1},8,["modelValue","size","checked-color","min","max"])])),_:1})):k("",!0),"radio"!==e.type||h(q)(P.value)?k("",!0):(i(),c(a,{key:1,id:"wd-radio-group"},{default:d((()=>[u(R,{modelValue:P.value,"onUpdate:modelValue":l[2]||(l[2]=e=>P.value=e),cell:"",size:e.selectSize,"checked-color":e.checkedColor,onChange:pe},{default:d((()=>[(i(!0),f(y,null,w(le.value,((l,o)=>(i(),c(a,{key:o,id:"radio"+l[e.valueKey]},{default:d((()=>[u(E,{value:l[e.valueKey],disabled:l.disabled},{default:d((()=>[e.filterable&&ee.value?(i(!0),f(y,{key:0},w(l[e.labelKey],(e=>(i(),c(V,{key:e.label,class:p(""+("active"===e.type?"wd-select-picker__text-active":""))},{default:d((()=>[v(b(e.label),1)])),_:2},1032,["class"])))),128)):(i(),f(y,{key:1},[v(b(l[e.labelKey]),1)],64))])),_:2},1032,["value","disabled"])])),_:2},1032,["id"])))),128))])),_:1},8,["modelValue","size","checked-color"])])),_:1})),e.loading?(i(),c(a,{key:2,class:"wd-select-picker__loading",onTouchmove:de},{default:d((()=>[u(H,{color:e.loadingColor},null,8,["color"])])),_:1})):k("",!0)])),_:1},8,["class","scroll-y","scroll-top"]),_e.value?(i(),c(a,{key:1,class:"wd-select-picker__footer"},{default:d((()=>[u(G,{block:"",size:"large",onClick:ve,disabled:e.loading},{default:d((()=>[v(b(e.confirmButtonText||h(z)("confirm")),1)])),_:1},8,["disabled"])])),_:1})):k("",!0)])),_:1},8,["modelValue","title","close-on-click-modal","z-index","safe-area-inset-bottom"])])),_:3},8,["class","style"])}}}),[["__scopeId","data-v-362dd514"]]);export{Y as _};
