import{d as t,r as n,x as e,y as u,e as s,f as a,w as i,g as l,n as o,C as r,A as c,s as d,k as p,a2 as m,ac as b}from"./index-ddWhPHnE.js";import{b as f,l as h,q as v,m as w,d as _,k as g,c as N,s as x,i as I,w as M,E as y,_ as S}from"./wd-icon.CdzlT4Xd.js";var W=(t=>(t.Input="input",t.Blur="blur",t.Watch="watch",t.Button="button",t))(W||{});function C(){}const P=S(t({name:"wd-input-number",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"},props:{...f,modelValue:h(v),min:w(1),max:w(Number.MAX_SAFE_INTEGER),step:w(1),stepStrictly:_(!1),precision:g(0),disabled:_(!1),disableInput:_(!1),disableMinus:_(!1),disablePlus:_(!1),withoutInput:_(!1),inputWidth:g(36),allowNull:_(!1),placeholder:N(""),adjustPosition:_(!0),beforeChange:Function,longPress:_(!1)},emits:["focus","blur","change","update:modelValue"],setup(t,{emit:f}){const h=t,v=f,w=n(function(){const t=q(h.modelValue);S(t,h.modelValue)||v("update:modelValue",t);return t}());let _=null;const g=e((()=>{const t=q(w.value),{disabled:n,min:e,step:u}=h;return n||Number(t)<=e||B(t,-u)<e})),N=e((()=>{const t=q(w.value),{disabled:n,max:e,step:u}=h;return n||Number(t)>=e||B(t,u)>e}));function S(t,n){return y(String(t),String(n))}function P(t){const n=Number(h.precision);return Number(parseFloat(""+Math.round(t*Math.pow(10,n))/Math.pow(10,n)).toFixed(n))}function T(t){if(!I(t))return 0;const n=t.toString(),e=n.indexOf(".");let u=0;return-1!==e&&(u=n.length-e-1),u}function V(t,n=W.Input){const e=n!==W.Watch,u=n===W.Blur||n===W.Button;if((n===W.Input||n===W.Watch)&&String(t).endsWith(".")&&h.precision)return w.value=t,void b((()=>{w.value=function(t){if(Number(h.precision)>0){const n=t.indexOf(".");return-1===n?t:t.substring(0,n+1)+t.substring(n+1).replace(/\./g,"")}{const n=t.indexOf(".");return-1!==n?t.substring(0,n):t}}(String(t)),v("update:modelValue",w.value),v("change",{value:w.value})}));if(!u&&S(t,w.value))return;const s=()=>function(t){w.value=t;const n=q(t);b((()=>{w.value=n,v("update:modelValue",w.value),v("change",{value:w.value})}))}(t);e?function(t,{args:n=[],done:e,canceled:u,error:s}){if(t){const a=t.apply(null,n);x(a)?a.then((t=>{t?e():u&&u()})).catch(s||C):a?e():u&&u()}else e()}(h.beforeChange,{args:[t],done:s}):s()}function B(t,n){if(t=Number(t),isNaN(t))return h.min;const e=Math.max(T(t),T(n)),u=Math.pow(10,e);return P((t*u+n*u)/u)}function j(t){!function(t){if(t<0&&(g.value||h.disableMinus)||t>0&&(N.value||h.disablePlus))return;V(B(w.value,t),W.Button)}("add"===t?h.step:-h.step)}function k(t){V(t.detail.value||"",W.Input)}function F(t){const n=t.detail.value||"";V(n,W.Blur),v("blur",{value:n})}function E(t){$(),_=setTimeout((()=>{j(t),E(t)}),250)}function A(t){h.longPress&&($(),_=setTimeout((()=>{j(t),E(t)}),600))}function O(){h.longPress&&$()}function $(){_&&(clearTimeout(_),_=null)}function G(t){v("focus",t.detail)}function q(t){if(h.allowNull&&(!I(t)||""===t))return"";let n=Number(t);return isNaN(n)&&(n=h.min),h.stepStrictly&&(n=function(t){const n=T(h.step),e=Math.pow(10,n);return Math.round(Number(t)/h.step)*e*h.step/e}(t)),n=Math.min(Math.max(n,h.min),h.max),I(h.precision)&&(n=P(n)),n}return u((()=>h.modelValue),(t=>{V(t,W.Watch)})),u([()=>h.max,()=>h.min,()=>h.precision],(()=>{V(q(w.value),W.Watch)})),(t,n)=>{const e=p,u=m;return s(),a(e,{class:o(`wd-input-number ${t.customClass} ${t.disabled?"is-disabled":""} ${t.withoutInput?"is-without-input":""}`),style:c(t.customStyle)},{default:i((()=>[l(e,{class:o("wd-input-number__action "+(g.value||t.disableMinus?"is-disabled":"")),onClick:n[0]||(n[0]=t=>j("sub")),onTouchstart:n[1]||(n[1]=t=>A("sub")),onTouchend:r(O,["stop"])},{default:i((()=>[l(M,{name:"decrease","custom-class":"wd-input-number__action-icon"})])),_:1},8,["class"]),t.withoutInput?d("",!0):(s(),a(e,{key:0,class:"wd-input-number__inner",onClick:n[2]||(n[2]=r((()=>{}),["stop"]))},{default:i((()=>[l(u,{class:"wd-input-number__input",style:c(""+(t.inputWidth?"width: "+t.inputWidth:"")),type:"digit",disabled:t.disabled||t.disableInput,value:String(w.value),placeholder:t.placeholder,"adjust-position":t.adjustPosition,onInput:k,onFocus:G,onBlur:F},null,8,["style","disabled","value","placeholder","adjust-position"]),l(e,{class:"wd-input-number__input-border"})])),_:1})),l(e,{class:o("wd-input-number__action "+(N.value||t.disablePlus?"is-disabled":"")),onClick:n[3]||(n[3]=t=>j("add")),onTouchstart:n[4]||(n[4]=t=>A("add")),onTouchend:r(O,["stop"])},{default:i((()=>[l(M,{name:"add","custom-class":"wd-input-number__action-icon"})])),_:1},8,["class"])])),_:1},8,["class","style"])}}}),[["__scopeId","data-v-de14ecb4"]]);export{P as _};
